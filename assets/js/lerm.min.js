(function(){"use strict";let e=$("#archives");let t=$(".month-list",e);let a=$(".month-post-list",e);let n=$(".post-list",e);let o=$(".post-list:first",e);n.hide();o.show();t.first().show();a.css("cursor","s-resize").on("click",function(){$(this).next().slideToggle(400)});var s=function(e,t,a){if(e>n.length){return}if(t=="up"){n.eq(e).slideUp(a,function(){s(e+1,t,a-10<1?0:a-10)})}else{n.eq(e).slideDown(a,function(){s(e+1,t,a-10<1?0:a-10)})}};$("#al_expand_collapse").on("click",function(e){e.preventDefault();if($(this).data("s")){$(this).data("s","");s(0,"up",100)}else{$(this).data("s",1);s(0,"down",100)}});$(document).on("click",'[data-toggle="lightbox"]',function(e){e.preventDefault();return $(this).ekkoLightbox()})})($);document.addEventListener("DOMContentLoaded",function(e){let t=document.documentElement;let a=document.body;let n=document.querySelectorAll(".dropdown");if(n){n.forEach(e=>{e.onmouseover=(()=>e.querySelector(".dropdown-menu").classList.add("show"));e.onmouseout=(()=>e.querySelector(".dropdown-menu").classList.remove("show"))})}let o=a.querySelector(".menu-backdrop");if(!o){return}let s=document.body.clientWidth;let l=a.querySelector("#site-header");let r=document.querySelector("#navbar");if(!r){return}let i=document.querySelector("#site-navigation");if(!i){return}let d=i.querySelector(".menu-toggle");if("undefined"===typeof d){return}let c=i.querySelector("ul");if(!c){d.style.display="none"}else{c.setAttribute("aria-expanded","false");let e=c.querySelectorAll("a");let n=c.getElementsByClassName("dropdown-menu");for(let e=0,t=n.length;e<t;e++){n[e].parentNode.setAttribute("aria-haspopup","true")}e.forEach(e=>{if(!e.classList.contains("dropdown-toggle"))e.onclick=function(){a.classList.remove("nav-opened");i.classList.remove("toggled");o.classList.remove("show");t.classList.remove("noscroll")}})}if(s<992){r.style.top=document.defaultView.getComputedStyle(t,null).marginTop}d.onclick=function(){if(-1!=i.className.indexOf("toggled")){i.classList.remove("toggled");a.classList.remove("nav-opened");d.setAttribute("aria-expanded","false");c.setAttribute("aria-expanded","false");o.classList.remove("show");t.classList.remove("noscroll")}else{a.classList.add("nav-opened");i.classList.add("toggled");d.setAttribute("aria-expanded","true");c.setAttribute("aria-expanded","true");o.classList.add("show");t.classList.add("noscroll")}};let u=false;o.addEventListener("touchmove",()=>{u=true});o.addEventListener("touchend",e=>{e.preventDefault();if(false===u){if(-1!==o.className.indexOf("show")){a.classList.remove("nav-opened");i.classList.remove("toggled");o.classList.remove("show");t.classList.remove("noscroll")}}});o.addEventListener("touchstart",function(){u=false});document.querySelectorAll("#wp-calendar tbody td a").forEach(e=>{e.classList.add("has-posts")});let m=new LazyLoad({elements_selector:".lazy",threshold:0});if(m){m.update()}if("undefined"!==typeof hljs){document.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)})}let f=document.getElementById("scroll-up");f.addEventListener("click",e=>{e.preventDefault();animate({duration:700,timing:g,draw:e=>t.scrollTop=t.scrollTop*(1-e/7)})});window.addEventListener("scroll",p);function p(){pageYOffset>=500&&f.classList.add("show");pageYOffset<500&&f.classList.remove("show")}let h=e=>1-Math.sin(Math.acos(e>1?e=1:e));let y=e=>t=>1-e(1-t);let g=y(h);let v=document.querySelector(".more-posts");if(v){v.addEventListener("click",e=>{e.preventDefault();v.innerHTML=adminajax.loading;let t=new FormData;t.append("query",adminajax.posts);t.append("page",adminajax.current);t.append("security",adminajax.nonce);t.append("action","lerm_load_more");fetch(adminajax.url,{method:"POST",body:t}).then(e=>e.text()).then(e=>{if(e.length){adminajax.current++;let t=parseToDOM(e);t.forEach(e=>{document.querySelector(".ajax-posts").appendChild(e);if(e.childNodes.length){e.classList.add("ajax-loading")}});return document.querySelectorAll(".ajax-loading")}v.innerHTML=adminajax.noposts;throw e}).then(e=>{Array.prototype.slice.call(e).forEach(e=>{fadeIn(e);e.classList.remove("ajax-loading")});v.innerHTML=adminajax.loadmore}).catch(e=>{v.setAttribute("disabled","true");v.setAttribute("aria-disabled","true")})})}let L=document.querySelector("#like-button");if(L){let e=L.dataset.id;let t=new FormData;t.append("action","lerm_post_like");t.append("postID",e);t.append("security",adminajax.nonce);L.addEventListener("click",e=>{e.preventDefault();if(!L.classList.contains("done")){fetch(adminajax.url,{method:"POST",body:t}).then(e=>e.json()).then(e=>{L.classList.add("done");L.disabled=true;document.querySelector(".count").innerHTML=parseInt(e)}).catch(e=>console.log(e.message))}})}let b=document.getElementById("commentform");if(b){b.insertAdjacentHTML("beforeend",'<div id="error" class="text-danger wow"></div>');let e=b.querySelector("#error");let t=b.querySelector('[name="author"]');let a=b.querySelector('[name="email"]');let n=b.querySelector('[name="url"]');let o=b.querySelector('[name="comment"]');e.style.visibility="hidden";e.innerHTML="#";b.addEventListener("submit",s=>{s.preventDefault();e.removeAttribute("style");e.classList.remove("shake");e.classList.remove("fadeOut");e.innerHTML='<strong><i class="fa fa-spinner fa-pulse mr-1"></i>正在提交...</strong>';(new WOW).init();if(!adminajax.loggedin){let o={author:t.value,email:a.value,url:n.value};if(!o.author){e.innerHTML="<strong>错误：</strong>请填写姓名";e.classList.add("shake");return}if(!validateEmail(o.email)){e.innerHTML="<strong>错误：</strong>请填写正确的电子邮箱";e.classList.add("shake");return}}if(!o.value){e.innerHTML="<strong>错误：</strong>请输入评论内容";e.classList.add("shake");return}let l=new URLSearchParams(new FormData(b));l.append("action","ajax_comment");l.append("security",adminajax.nonce);fetch(adminajax.url,{method:"POST",body:l}).then(e=>e.text()).then(e=>{let t=parseToDOM(e);if("STRONG"===t[0].nodeName||t.length===1){throw t}let a=document.getElementById("respond");if(a.parentNode.classList.contains("comment")){if(null!==a.nextElementSibling){t.forEach(e=>{a.nextElementSibling.appendChild(e);b.querySelector('[type="submit"]').removeAttribute("disabled","disabled")})}else{t.forEach(e=>{a.parentNode.appendChild(e);b.querySelector('[type="submit"]').removeAttribute("disabled","disabled")})}}if(document.querySelector(".comment-list")){t.forEach(e=>{document.querySelector(".comment-list").insertBefore(e,document.querySelector(".comment-list").firstChild);b.querySelector('[type="submit"]').removeAttribute("disabled","disabled")})}else{t.forEach(e=>{a.parentNode.appendChild(e);b.querySelector('[type="submit"]').removeAttribute("disabled","disabled")})}}).then(()=>{b.querySelector("#comment").value="";e.innerHTML='<strong><i class="fa fa-ok mr-1"></i>提交成功</strong>';let t=setTimeout(function(){e.classList.add("fadeOut");e.style.opacity=0;clearTimeout(t)},3e3)}).catch(t=>{console.log(t);e.innerHTML=" ";t.forEach(t=>{e.appendChild(t);let a=setTimeout(function(){e.classList.add("fadeOut");e.style.opacity=0;clearTimeout(a)},3e3)})})})}});function parseToDOM(e){let t=document.createElement("div");if(typeof e=="string")t.innerHTML=e;return Array.prototype.slice.call(t.childNodes)}const matches=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)};function fadeIn(e){e.style.opacity=0;var t=+new Date;var a=function(){e.style.opacity=+e.style.opacity+(new Date-t)/400;t=+new Date;if(+e.style.opacity<1){window.requestAnimationFrame&&requestAnimationFrame(a)||setTimeout(a,16)}};a()}function validateEmail(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())}function animate(e){let t=performance.now();requestAnimationFrame(function a(n){let o=(n-t)/e.duration;o>1&&(o=1);let s=e.timing(o);e.draw(s);o<1&&requestAnimationFrame(a)})}