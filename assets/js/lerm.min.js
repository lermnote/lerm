(function(){document.addEventListener("DOMContentLoaded",function(e){const t=new WOW({boxClass:"loading-animate",animateClass:"animated",offset:0,mobile:true});t.init();const n=document.documentElement;const o=document.body;const a=e=>{const t=document.querySelectorAll(e);if(t.length===0){return}const n=t[0];const o=n.querySelector("img").offsetWidth;const a=n.querySelector("img").offsetHeight;t.forEach(e=>{e.querySelector("img").style.width=o+"px";e.querySelector("img").style.height=a+"px"})};const s=document.querySelectorAll(".dropdown");s.forEach(e=>{e.addEventListener("mouseover",()=>{e.querySelector(".dropdown-menu").classList.add("show")});e.addEventListener("mouseout",()=>{e.querySelector(".dropdown-menu").classList.remove("show")})});const r=document.body.clientWidth;const c=document.querySelector("#site-header");const i=document.querySelector("#offcanvasMenu");if(r<992){i.style.top=parseFloat(getComputedStyle(document.documentElement).marginTop)+"px"}v;let l=new LazyLoad({elements_selector:".lazy",threshold:0});if(l){l.update()}if("undefined"!==typeof hljs){document.querySelectorAll("pre code").forEach(e=>{hljs.highlightBlock(e)})}let d=document.getElementById("scroll-up");d.addEventListener("click",e=>{e.preventDefault();T({timing:e=>n.scrollTop=n.scrollTop*(1-e),draw:e=>1-Math.sin(Math.acos(e)),duration:700})});const u=document.querySelector(".like-button");const m=document.querySelector(".count");if(u&&!u.classList.contains("done")){let t=u.dataset.id;let n=localStorage.getItem("count_"+t);if(n){m.innerHTML=parseInt(n)}u.addEventListener("click",e=>{e.preventDefault();if(!n){let e=new URLSearchParams;e.append("action","lerm_post_like");e.append("security",adminajax.nonce);e.append("post_ID",t);fetch(adminajax.url,{method:"POST",body:e}).then(e=>e.json()).then(e=>{localStorage.setItem("count_"+t,e);m.innerHTML=parseInt(e)}).catch(e=>console.log(e.message))}else{m.innerHTML=parseInt(n)}u.classList.add("done");u.disabled=true})}const f=document.getElementById("commentform");const p=e=>{message.innerHTML=`<strong><i class="fa fa-ok me-1"></i>${e}</strong>`;message.classList.add("shake","show");setTimeout(()=>message.classList.remove("shake","show"),3e3)};const h=e=>{message.innerHTML=`<strong><i class="fa fa-xmark me-1"></i>${e}</strong>`;message.classList.add("show");setTimeout(()=>message.classList.remove("show"),3e3)};if(f){f.insertAdjacentHTML("beforeend",'<div id="message" class="text-danger wow"></div>');const message=f.querySelector("#message");const y=f.querySelector('[name="author"]');const g=f.querySelector('[name="email"]');const S=f.querySelector('[name="url"]');const w=f.querySelector('[name="comment"]');f.addEventListener("click",async e=>{if(e.target.type==="submit"&&e.target.closest("#commentform")){e.preventDefault();message.removeAttribute("style");message.classList.remove("shake","fadeOut");message.innerHTML='<strong><i class="fa fa-spinner fa-pulse me-1"></i>正在提交...</strong>';(new WOW).init();if(!adminajax.loggedin){const n={author:y.value,email:g.value,url:S.value};if(!n.author){p("请填写姓名");return}if(!b(n.email)){p("请填写正确的电子邮箱");return}}if(!w.value){p("请输入评论内容");return}const t=new URLSearchParams(new FormData(f));t.append("action","ajax_comment");t.append("security",adminajax.nonce);try{const o=await fetch(adminajax.url,{method:"POST",body:t});const{success:a,data:s}=await o.json();if(a&&s.length!==0){const r=q(s);const c=r[1];const i=document.getElementById("respond");e.target.setAttribute("disabled","disabled");if(i.parentNode.classList.contains("comment")){i.previousElementSibling?.appendChild(c)??i.parentNode.appendChild(c)}else if(document.querySelector(".comment-list")){document.querySelector(".comment-list").insertBefore(c,document.querySelector(".comment-list").firstChild)}else{i.parentNode.insertAdjacentHTML("beforeend",`
						<div class="card mb-3">
							<ol class="comment-list p-0 m-0 list-group list-group-flush">
								${c.outerHTML}
							</ol>
						</div>
					`)}h("评论已成功提交");f.querySelector("#comment").value=""}else{p("评论提交失败，请刷新后重试");console.error(s)}}catch(e){p("评论提交失败，请刷新后重试！");console.log(e)}finally{e.target.removeAttribute("disabled");setTimeout(()=>message.classList.remove("show"),3e3)}}})}L();v()});function e(e){if(typeof e!=="function"){return}if(document.readyState==="interactive"||document.readyState==="complete"){return e()}document.addEventListener("DOMContentLoaded",e,false)}e(function(){});const L=()=>{const s=document.querySelector(".more-posts");if(s===null){console.error("Can't find element with class '.more-posts'");return}if(typeof s!="undefined"&&s!=null){s.addEventListener("click",e=>{e.preventDefault();s.innerHTML=adminajax.loading;let n=document.querySelector(".ajax-posts");let o=n.dataset.page;let a=n.dataset.max;let t=new URLSearchParams;t.append("action","load_more");t.append("query",adminajax.posts);t.append("security",adminajax.nonce);t.append("current_page",o);t.append("max_pages",a);fetch(adminajax.url,{method:"POST",body:t}).then(e=>{if(!e.ok){throw new Error(`HTTP error! status: ${e.status}`)}return e.json()}).then(t=>{if(!t.success){throw new Error(`Data request failed! Error: ${t.message}`)}if(o==a){throw t}if(t.success==true){let e=q(t.data);n.dataset.page++;e.forEach(e=>{document.querySelector(".ajax-posts").appendChild(e)})}s.innerHTML=adminajax.loadmore;s.blur()}).catch(e=>{s.innerHTML=adminajax.noposts;s.blur();s.setAttribute("disabled","true");s.setAttribute("aria-disabled","true")})})}};const v=()=>{const e=document.querySelector("#wp-calendar");if(e===null){console.error("Can't find element with id '#wp-calendar'");return}const t=e.querySelectorAll("tbody td a");t.forEach(e=>{e.classList.add("has-posts")})};const q=function(e){let t=document.createElement("div");if(typeof e=="string")t.innerHTML=e;return Array.prototype.slice.call(t.childNodes)};const t=function(e,t){return(e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector).call(e,t)};function n(e){e.style.opacity=0;var t=+new Date;var n=function(){e.style.opacity=+e.style.opacity+(new Date-t)/400;t=+new Date;if(+e.style.opacity<1){window.requestAnimationFrame&&requestAnimationFrame(n)||setTimeout(n,16)}};n()}const b=function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(String(e).toLowerCase())};let T=o=>{let a=performance.now();let s=e=>{let t=(e-a)/o.duration;if(t>1)t=1;let n=o.timing(t);o.draw(n);if(t<1){requestAnimationFrame(s)}};requestAnimationFrame(s)}})();